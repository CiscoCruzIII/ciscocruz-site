<!--
    Assignment 3 – HTML5 & JavaScript Form

    This file implements a polished, multi‑step form that collects a user's
    contact details, validates the input client‑side and then presents a
    confirmation screen before finally constructing a mailto link to send
    the information.  All validation rules from the assignment are adhered
    to: names cannot be blank, the address requires street, city, state
    (chosen from a dropdown) and ZIP code, the phone is constrained to a
    10‑digit US number formatted like (000)000‑0000, emails must conform
    to a basic pattern, birthdates cannot be in the future, and a simple
    “human check” question deters bots.  Styles are written inline for
    convenience but separated logically to make future modifications easy.

    To use this form on your own site just open this file in a browser.
    When you hit “Send”, your default mail program will open a new email
    addressed to the course instructor (replace the email address in the
    JavaScript with your own), prefilled with the data supplied by the
    user.  No server‑side logic is required.
-->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contact Form – Assignment&nbsp;3</title>
  <style>
    /* Base typography and colors */
    :root {
      --primary-color: #2A7AE2;
      --secondary-color: #F4F6F8;
      --accent-color: #E63946;
      --text-color: #333;
      --error-color: #D9534F;
    }
    body {
      font-family: Arial, Helvetica, sans-serif;
      margin: 0;
      padding: 0;
      background: var(--secondary-color);
      color: var(--text-color);
    }
    header {
      background: var(--primary-color);
      color: white;
      padding: 1rem 2rem;
      text-align: center;
    }
    main {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 2rem 1rem;
    }
    .container {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 720px;
      padding: 2rem;
    }
    h1 {
      margin-top: 0;
    }
    .field {
      margin-bottom: 1.2rem;
    }
    label {
      display: block;
      margin-bottom: 0.4rem;
      font-weight: bold;
    }
    input[type="text"], input[type="email"], input[type="tel"], input[type="date"], textarea, select {
      width: 100%;
      padding: 0.6rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
    }
    textarea {
      min-height: 120px;
      resize: vertical;
    }
    .form-row {
      display: flex;
      gap: 1rem;
    }
    .form-row .field {
      flex: 1;
    }
    .error {
      color: var(--error-color);
      font-size: 0.9rem;
      margin-top: 0.2rem;
    }
    .buttons {
      display: flex;
      justify-content: flex-end;
      gap: 0.5rem;
    }
    button {
      padding: 0.7rem 1.4rem;
      border: none;
      border-radius: 4px;
      font-size: 1rem;
      cursor: pointer;
    }
    button[type="submit"] {
      background: var(--primary-color);
      color: white;
    }
    button.secondary {
      background: #6c757d;
      color: white;
    }
    .hidden {
      display: none;
    }
    /* Confirmation display */
    #confirmation {
      line-height: 1.6;
    }
    #confirmation span.label {
      font-weight: bold;
      display: inline-block;
      width: 110px;
    }
  </style>
</head>
<body>
  <header>
    <h1>Contact Form</h1>
    <p>Please provide your details and message below.</p>
  </header>
  <main>
    <div class="container" id="form-container">
      <form id="contactForm" novalidate>
        <!-- Name -->
        <div class="field form-row">
          <div class="field">
            <label for="firstname">First Name<span class="required">*</span></label>
            <input type="text" id="firstname" name="firstname" required placeholder="John">
            <div class="error" id="firstnameError"></div>
          </div>
          <div class="field">
            <label for="lastname">Last Name<span class="required">*</span></label>
            <input type="text" id="lastname" name="lastname" required placeholder="Doe">
            <div class="error" id="lastnameError"></div>
          </div>
        </div>
        <!-- Address -->
        <div class="field">
          <label for="address">Street Address<span class="required">*</span></label>
          <input type="text" id="address" name="address" required placeholder="123 Main St">
          <div class="error" id="addressError"></div>
        </div>
        <div class="field form-row">
          <div class="field">
            <label for="city">City<span class="required">*</span></label>
            <input type="text" id="city" name="city" required placeholder="Bunnell">
            <div class="error" id="cityError"></div>
          </div>
          <div class="field">
            <label for="state">State<span class="required">*</span></label>
            <select id="state" name="state" required>
              <option value="">Select…</option>
              <option value="AL">Alabama</option>
              <option value="AK">Alaska</option>
              <option value="AZ">Arizona</option>
              <option value="AR">Arkansas</option>
              <option value="CA">California</option>
              <option value="CO">Colorado</option>
              <option value="CT">Connecticut</option>
              <option value="DE">Delaware</option>
              <option value="FL">Florida</option>
              <option value="GA">Georgia</option>
              <option value="HI">Hawaii</option>
              <option value="ID">Idaho</option>
              <option value="IL">Illinois</option>
              <option value="IN">Indiana</option>
              <option value="IA">Iowa</option>
              <option value="KS">Kansas</option>
              <option value="KY">Kentucky</option>
              <option value="LA">Louisiana</option>
              <option value="ME">Maine</option>
              <option value="MD">Maryland</option>
              <option value="MA">Massachusetts</option>
              <option value="MI">Michigan</option>
              <option value="MN">Minnesota</option>
              <option value="MS">Mississippi</option>
              <option value="MO">Missouri</option>
              <option value="MT">Montana</option>
              <option value="NE">Nebraska</option>
              <option value="NV">Nevada</option>
              <option value="NH">New Hampshire</option>
              <option value="NJ">New Jersey</option>
              <option value="NM">New Mexico</option>
              <option value="NY">New York</option>
              <option value="NC">North Carolina</option>
              <option value="ND">North Dakota</option>
              <option value="OH">Ohio</option>
              <option value="OK">Oklahoma</option>
              <option value="OR">Oregon</option>
              <option value="PA">Pennsylvania</option>
              <option value="RI">Rhode Island</option>
              <option value="SC">South Carolina</option>
              <option value="SD">South Dakota</option>
              <option value="TN">Tennessee</option>
              <option value="TX">Texas</option>
              <option value="UT">Utah</option>
              <option value="VT">Vermont</option>
              <option value="VA">Virginia</option>
              <option value="WA">Washington</option>
              <option value="WV">West Virginia</option>
              <option value="WI">Wisconsin</option>
              <option value="WY">Wyoming</option>
            </select>
            <div class="error" id="stateError"></div>
          </div>
          <div class="field">
            <label for="zip">ZIP Code<span class="required">*</span></label>
            <input type="text" id="zip" name="zip" required pattern="\d{5}(?:-\d{4})?" placeholder="32110">
            <div class="error" id="zipError"></div>
          </div>
        </div>
        <!-- Phone -->
        <div class="field">
          <label for="phone">Phone Number<span class="required">*</span></label>
          <input type="tel" id="phone" name="phone" required maxlength="14" placeholder="(123)456-7890">
          <div class="error" id="phoneError"></div>
        </div>
        <!-- Email -->
        <div class="field">
          <label for="email">Email Address<span class="required">*</span></label>
          <input type="email" id="email" name="email" required placeholder="you@example.com">
          <div class="error" id="emailError"></div>
        </div>
        <!-- Birth Date -->
        <div class="field">
          <label for="birthdate">Birth Date<span class="required">*</span></label>
          <input type="date" id="birthdate" name="birthdate" required>
          <div class="error" id="birthdateError"></div>
        </div>
        <!-- Message -->
        <div class="field">
          <label for="message">Message<span class="required">*</span></label>
          <textarea id="message" name="message" required placeholder="How can we help you?"></textarea>
          <div class="error" id="messageError"></div>
        </div>
        <!-- Confirmation / human check -->
        <div class="field">
          <label for="confirm">What is 4 + 3? (to prove you are human)<span class="required">*</span></label>
          <input type="text" id="confirm" name="confirm" required placeholder="Answer">
          <div class="error" id="confirmError"></div>
        </div>
        <div class="buttons">
          <button type="submit">Submit</button>
        </div>
      </form>
    </div>
    <!-- Confirmation page -->
    <div class="container hidden" id="confirmation-container">
      <h2>Please Confirm Your Details</h2>
      <div id="confirmation"></div>
      <div class="buttons">
        <button class="secondary" id="editButton">Edit</button>
        <button id="sendButton" type="button">Send</button>
      </div>
    </div>
  </main>
  <script>
    // Utility function to trim whitespace
    function trim(str) {
      return str.replace(/^\s+|\s+$/g, '');
    }
    // Phone input mask: formats as (123)456-7890
    const phoneInput = document.getElementById('phone');
    phoneInput.addEventListener('input', function(e) {
      let digits = this.value.replace(/\D/g, '');
      if (digits.length > 10) {
        digits = digits.substring(0, 10);
      }
      let formatted = '';
      if (digits.length > 0) {
        formatted += '(' + digits.substring(0, 3);
      }
      if (digits.length >= 3) {
        formatted += ')';
      }
      if (digits.length >= 4) {
        formatted += digits.substring(3, 6);
      }
      if (digits.length >= 6) {
        formatted += '-';
        formatted += digits.substring(6);
      }
      this.value = formatted;
    });
    // Set maximum date for birthdate to today
    const birthdateInput = document.getElementById('birthdate');
    const today = new Date().toISOString().split('T')[0];
    birthdateInput.setAttribute('max', today);
    // Form validation and submission
    const form = document.getElementById('contactForm');
    const confirmationContainer = document.getElementById('confirmation-container');
    const formContainer = document.getElementById('form-container');
    const confirmationDiv = document.getElementById('confirmation');
    form.addEventListener('submit', function(event) {
      event.preventDefault();
      // Clear previous errors
      document.querySelectorAll('.error').forEach(err => err.textContent = '');
      let valid = true;
      // First name and last name
      const firstname = trim(document.getElementById('firstname').value);
      const lastname = trim(document.getElementById('lastname').value);
      if (!firstname) {
        document.getElementById('firstnameError').textContent = 'First name is required.';
        valid = false;
      }
      if (!lastname) {
        document.getElementById('lastnameError').textContent = 'Last name is required.';
        valid = false;
      }
      // Address
      const address = trim(document.getElementById('address').value);
      const city = trim(document.getElementById('city').value);
      const state = document.getElementById('state').value;
      const zip = trim(document.getElementById('zip').value);
      if (!address) {
        document.getElementById('addressError').textContent = 'Street address is required.';
        valid = false;
      }
      if (!city) {
        document.getElementById('cityError').textContent = 'City is required.';
        valid = false;
      }
      if (!state) {
        document.getElementById('stateError').textContent = 'State is required.';
        valid = false;
      }
      const zipPattern = /^\d{5}(?:-\d{4})?$/;
      if (!zipPattern.test(zip)) {
        document.getElementById('zipError').textContent = 'Enter a valid ZIP code (e.g., 12345 or 12345-6789).';
        valid = false;
      }
      // Phone
      const phoneRaw = document.getElementById('phone').value;
      const phoneDigits = phoneRaw.replace(/\D/g, '');
      if (phoneDigits.length !== 10) {
        document.getElementById('phoneError').textContent = 'Enter a 10-digit phone number.';
        valid = false;
      }
      // Email
      const email = trim(document.getElementById('email').value);
      const emailPattern = /^[\w.-]+@[\w.-]+\.[A-Za-z]{2,}$/;
      if (!emailPattern.test(email)) {
        document.getElementById('emailError').textContent = 'Enter a valid email address.';
        valid = false;
      }
      // Birthdate
      const birthdateValue = document.getElementById('birthdate').value;
      if (!birthdateValue) {
        document.getElementById('birthdateError').textContent = 'Birth date is required.';
        valid = false;
      } else {
        const birthDate = new Date(birthdateValue);
        const now = new Date();
        if (birthDate > now) {
          document.getElementById('birthdateError').textContent = 'Birth date cannot be in the future.';
          valid = false;
        }
      }
      // Message
      const message = trim(document.getElementById('message').value);
      if (!message) {
        document.getElementById('messageError').textContent = 'Please enter a message.';
        valid = false;
      }
      // Confirmation question
      const confirmAnswer = trim(document.getElementById('confirm').value);
      if (confirmAnswer !== '7') {
        document.getElementById('confirmError').textContent = 'Incorrect answer. Please try again.';
        valid = false;
      }
      if (valid) {
        // Build confirmation display
        confirmationDiv.innerHTML = '';
        const lines = [
          {label: 'Name', value: firstname + ' ' + lastname},
          {label: 'Address', value: address + ', ' + city + ', ' + state + ' ' + zip},
          {label: 'Phone', value: phoneRaw},
          {label: 'Email', value: email},
          {label: 'Birthdate', value: birthdateValue},
          {label: 'Message', value: message.replace(/\n/g, '<br>')}
        ];
        lines.forEach(item => {
          const p = document.createElement('p');
          p.innerHTML = `<span class="label">${item.label}:</span> ${item.value}`;
          confirmationDiv.appendChild(p);
        });
        // Hide form, show confirmation
        formContainer.classList.add('hidden');
        confirmationContainer.classList.remove('hidden');
      }
    });
    // Edit button: show form again
    document.getElementById('editButton').addEventListener('click', function() {
      confirmationContainer.classList.add('hidden');
      formContainer.classList.remove('hidden');
    });
    // Send button: build mailto and open email client
    document.getElementById('sendButton').addEventListener('click', function() {
      // Read current values again from form (not from confirmation text)
      const firstname = trim(document.getElementById('firstname').value);
      const lastname = trim(document.getElementById('lastname').value);
      const address = trim(document.getElementById('address').value);
      const city = trim(document.getElementById('city').value);
      const state = document.getElementById('state').value;
      const zip = trim(document.getElementById('zip').value);
      const phone = document.getElementById('phone').value;
      const email = trim(document.getElementById('email').value);
      const birthdate = document.getElementById('birthdate').value;
      const message = trim(document.getElementById('message').value);
      // Compose subject and body
      const subject = encodeURIComponent('New form submission');
      let body = '';
      body += 'Name: ' + firstname + ' ' + lastname + '\n';
      body += 'Address: ' + address + ', ' + city + ', ' + state + ' ' + zip + '\n';
      body += 'Phone: ' + phone + '\n';
      body += 'Email: ' + email + '\n';
      body += 'Birthdate: ' + birthdate + '\n\n';
      body += 'Message:\n' + message + '\n';
      const encodedBody = encodeURIComponent(body);
      // Replace with your email address below
      const emailAddress = 'example@domain.com';
      const mailtoLink = 'mailto:' + emailAddress + '?subject=' + subject + '&body=' + encodedBody;
      window.location.href = mailtoLink;
      // After sending, optionally reset the form
      form.reset();
      // Show the form again with a clean state
      confirmationContainer.classList.add('hidden');
      formContainer.classList.remove('hidden');
    });
  </script>
</body>
</html>